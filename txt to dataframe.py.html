#!/usr/bin/env python
# coding: utf-8

# In[ ]:


#rename all files to add .txt
import os,glob
os.chdir("/Users/ntoscano/Desktop/Text Data/maildir_extract/")
for fi in glob.glob("*"):
   os.rename(fi, fi + ".txt") 


# In[ ]:


#rename only files with ..txt to add .txt
import os,glob
os.chdir("/Users/ntoscano/Desktop/Text Data/maildir_extract/")
for fi in glob.glob("*..txt"):
   os.rename(fi, fi[:-5] + ".txt")


# In[ ]:


#create single txt file
import glob

read_files = glob.glob("*.txt")

with open("result.txt", "wb") as outfile:
    for f in read_files:
        with open(f, "rb") as infile:
            outfile.write(infile.read())


# In[7]:


##import to list and then df
#import pandas as pd
#import os

#os.chdir("/Users/ntoscano/Desktop/Text Data/maildir_extract/")

#data = []
#path = "/Users/ntoscano/Desktop/Text Data/maildir_extract/"
#files = [f for f in os.listdir(path) if os.path.isfile(f)]
#for f in files:
#  with open (f, "rb") as myfile:
#    data.append(myfile.read())


#df = pd.DataFrame(data)
#print(df)


# In[8]:


##Export Results to csv
#os.chdir("/Users/ntoscano/Desktop/")
#df.to_csv('enron_emails.csv')


# In[9]:


import pandas as pd
import os

os.chdir("/Users/ntoscano/Desktop/Text Data/maildir_extract/")

file_names = os.listdir("/Users/ntoscano/Desktop/Text Data/maildir_extract/")
# Create Dictionary for File Name and Text
file_name_and_text = {}
for file in file_names:
    with open("/Users/ntoscano/Desktop/Text Data/maildir_extract/" + file, "rb") as target_file:
         file_name_and_text[file] = target_file.read()
file_data = (pd.DataFrame.from_dict(file_name_and_text, orient='index')
             .reset_index().rename(index = str, columns = {'index': 'file_name', 0: 'text'}))
print(file_data)


# In[ ]:


os.chdir("/Users/ntoscano/Desktop/")
df.to_csv('enron_emails.csv')

